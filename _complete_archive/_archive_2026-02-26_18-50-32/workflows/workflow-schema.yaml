version: 1
schema:
  id: workflow
  type: object
  required:
    - id
    - name
    - summary
    - primary_actor
    - preconditions
    - postconditions
    - happy_path
    - steps
  properties:
    id:
      type: string
      pattern: '^workflow\\.[a-z0-9_]+\\.[a-z0-9_]+$'
    name:
      type: string
    summary:
      type: string
    primary_actor:
      type: string
    preconditions:
      type: array
      items: { type: string }
    postconditions:
      type: array
      items: { type: string }
    happy_path:
      type: array
      items:
        type: object
        required: [step_id, feature_id, description]
        properties:
          step_id: { type: string }
          feature_id: { type: string }
          description: { type: string }
    steps:
      type: array
      items:
        type: object
        required: [step_id, feature_id]
        properties:
          step_id: { type: string }
          description: { type: string }
          feature_id: { type: string }
          system_tasks:
            type: array
            items: { type: string }
          ui_state: { type: string }
          inputs:
            type: array
            items: { type: string }
          outputs:
            type: array
            items: { type: string }
    alternate_flows:
      type: array
      items:
        type: object
        properties:
          id: { type: string }
          trigger: { type: string }
          recovery:
            type: array
            items: { type: string }
    failure_modes:
      type: array
      items:
        type: object
        properties:
          id: { type: string }
          cause: { type: string }
          behavior: { type: string }
    metrics:
      type: array
      items:
        type: object
        properties:
          name: { type: string }
